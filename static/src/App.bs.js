// Generated by BUCKLESCRIPT VERSION 4.0.14, PLEASE EDIT WITH CARE
'use strict';

var Pervasives = require("bs-platform/lib/js/pervasives.js");
var Json_decode = require("@glennsl/bs-json/src/Json_decode.bs.js");

function actionType(json) {
  var param = Json_decode.string(json);
  switch (param) {
    case "block" : 
        return /* Block */0;
    case "protest" : 
        return /* Protest */2;
    case "warn" : 
        return /* Warn */1;
    default:
      return Pervasives.failwith("unknown action type");
  }
}

function action(json) {
  return /* record */[
          /* action */Json_decode.field("action", actionType, json),
          /* reason */Json_decode.field("reason", Json_decode.string, json)
        ];
}

function rule(json) {
  return /* record */[
          /* sites */Json_decode.field("sites", (function (param) {
                  return Json_decode.list(Json_decode.string, param);
                }), json),
          /* actions */Json_decode.field("actions", (function (param) {
                  return Json_decode.list(action, param);
                }), json)
        ];
}

function policy(json) {
  return /* record */[
          /* name */Json_decode.field("name", Json_decode.string, json),
          /* website */Json_decode.field("website", Json_decode.string, json),
          /* rules */Json_decode.field("website", (function (param) {
                  return Json_decode.list(rule, param);
                }), json)
        ];
}

function policies(param) {
  return Json_decode.array(policy, param);
}

var Decode = /* module */[
  /* actionType */actionType,
  /* action */action,
  /* rule */rule,
  /* policy */policy,
  /* policies */policies
];

var url = "http://localhost:8000/";

function fetchPolicies(param) {
  return fetch("http://localhost:8000/policy").then((function (prim) {
                    return prim.json();
                  })).then((function (json) {
                  var policies = Json_decode.array(policy, json);
                  return Promise.resolve(policies);
                })).catch((function (_err) {
                return Promise.resolve(undefined);
              }));
}

fetchPolicies(/* () */0).then((function (value) {
        console.log(value);
        return Promise.resolve(value);
      }));

exports.Decode = Decode;
exports.url = url;
exports.fetchPolicies = fetchPolicies;
/*  Not a pure module */
